# Cursor 프로젝트 진행 순서

> 프로젝트 전체 운영 워크플로우 가이드

---

## 📋 Part 1: 프로젝트 진행 전 준비

### 1.1 프로젝트 기초 준비

**작업 순서**:
1. 프로젝트명 기준 폴더 생성
2. 하부 디렉토리 `/docs` 생성
3. `/docs`에 PRD 파일 넣기

### 1.2 프로젝트 계획 세우기

**작업 내용**:
- PRD 기반 프로젝트 플래닝 (플랜모드에서 요청)
- 커서 질문에 대한 답변으로 구체화
- **필수 패키지 확인**: `poetry.lock` 및 `pyproject.toml` 확인 요청
- **참고 코드 스니펫**: TODOs.md에 반영 요청
- **TODOs.md 작성**: 1차 작성 후 정제 요청

### 1.3 프로젝트 지침 및 컨텍스트 준비

**필수 파일 준비**:
- **AGENTS.md**: 파일 복사 후 프로젝트에 맞게 수정 (파워쉘 명령어, 환경변수 관리)
- **Cursor Rules**: PRD와 TODOs.md 기반 커서룰 작성 (명령어: `@.cursor/rules`)
- **API Contract**: API 계약 동기화 파일 복사 후 프로젝트에 맞게 각색하여 커서룰로 추가

**커서룰에 반영할 핵심 규칙**:
- **LLM 구조 output**: 구조화된 output 사용 시 contract 정합성 점검 필수
- **캐시저장**: 파싱/LLM 호출 결과는 반드시 캐싱 (재사용)
- **테스트 전략**: backend-frontend 별도 구성 시, backend E2E 테스트 완료 필수
- **Phase 완료 조건**: TODOs.md 업데이트 및 Git 커밋 필수

---

## ⚠️ Part 2: 프로젝트 진행 시 주의사항

### 2.1 Phase별 작업 원칙 (최우선)

**필수 준수 사항**:
- **AGENTS.md와 커서룰 항상 적용**: 모든 작업 시 리마인드 필수
- **Phase별 진행**: 한 번에 여러 Phase 진행 금지
- **사용자 피드백 필수**: 각 Phase 완료 후 피드백 대기
- **Phase 완료 시 필수 작업**:
  1. TODOs.md 업데이트 (체크박스 및 진행 상황 추적)
  2. Git 커밋 실행 (`feat: Phase X 완료 - [Phase 제목]`)

**Phase별 점검 항목**:
- TEST 이전: Phase 내 생성한 파일들의 정합성 확인
- TEST 파일: Phase 내 생성한 파일의 함수/변수 적정 재사용 확인
- 호출 순서: 함수 호출 순서의 올바름 확인

### 2.2 테스트 관련 주의사항

**테스트 원칙**:
- **실제 데이터 사용**: Mock 사용 절대 금지, 실제 데이터로 E2E 테스트
- **E2E 테스트 우선**: 실제 서버 실행하여 프로덕션 플로우와 동일하게 검증
- **백엔드 우선**: backend-frontend 별도 구성 시, backend E2E 테스트 완료 후 프론트엔드 진행

**테스트 실행 규칙**:
- **로그 보강 필수**: 문제 원인 파악을 위해 로그 최대한 보강
- **로그 저장**: 터미널 출력뿐만 아니라 파일로도 저장 (테스트 종료 후 피드백 가능)
- **재실행 금지**: 테스트 종료 후 설명 없이 바로 재실행 금지
  - 반드시 로그 분석 → 원인 및 개선책 설명 → 사용자 동의 후 재테스트
- **검증 스크립트**: 테스트 결과 검증을 위한 스크립트 사전 작성 (test 파일과 별도)
- **테스트 에러 기록**: 별도 마크다운 파일에 지속적으로 누적

**테스트 파일 작성 규칙**:
- **이모지 금지**: 테스트 파일에서 이모지 사용 시 인코딩 에러 발생
- **코드 재사용**: 테스트 파일에서 만든 로직을 일괄 처리 스크립트에서도 동일하게 사용

### 2.3 코드 품질 관리

**코드 작성 규칙**:
- **파워쉘 명령어**: 모듈 실행 (`python -m`) 자주 까먹음 → 리마인드 필수
- **인덴트 에러 방지**: `eslintrc` 및 `prettierrc` 반드시 사용
- **코드 마이그레이션 주의**: 테스트 파일 로직을 일괄 처리 스크립트에서 새로 만들지 말고 재사용

**파일 관리**:
- **README.md 업데이트**: 프로젝트 구조 변경 시 지속적으로 반영
- **.gitignore 주의**: 
  - Python의 `lib/`은 gitignore에 포함되지만, 프론트엔드의 `lib/`은 포함하면 안 됨
  - 원하지 않는 파일 포함 주의

### 2.4 디버깅 및 문제 해결

**디버깅 접근법**:
- **로그 기반 접근**: 에러 지속 시 로그 추가하여 원인을 단계적으로 좁혀가기
- **시나리오 검증**: 로그 추가 요청 시 시나리오 정합성 재확인
- **Sequential Thinking 활용**: 복잡한 문제는 단계별 분석

**로그 추가 요청 시 프로세스**:
1. 코드의 가능한 모든 줄에 로그 출력 보강
2. 로그 출력을 통한 원인 찾기 시나리오 검토
3. Sequential Thinking MCP 실행하여 확인
4. 모든 체크 완료 후 체크리스트 사용자에게 제시
5. 사용자 피드백 대기 (실행 금지)

**데이터 Coverage 확인**:
- 여러 Phase로 나눠진 경우, 첫 Phase에서 가능한 모든 데이터 수집 경로(소스, 카테고리 등) 실행 시 문제없음 확인

---

## ✅ Part 3: 프로젝트 완료 후 사후 체크

### 3.1 배포 전 검증

**빌드 검증**:
- **run build 실행**: 개발 모드(`run dev`) 외에 `run build`로 타입 에러 등 문제 사전 발견
- **타입 체크**: TypeScript 타입 에러 완전히 해결

**최종 점검**:
- 모든 Phase 완료 확인
- TODOs.md 최종 업데이트
- Git 커밋 및 푸시 완료

### 3.2 배포 후 확인 (배포 시 적용)

**백엔드 배포 (Railway 등)**:
- **기본 설정**: 도커 실행 루트 및 실행 명령(uvicorn) 인식 확인
- **환경변수**: `.env`에서 환경변수 확인 후 설정
- **CORS 설정**: 프론트엔드 앱 배포 후 CORS 재설정 확인
- **건강도 확인**: `url주소/health`로 확인
- **스케줄러**: 필요 시 스케줄러 추가 (command 입력, variable 추가)

**프론트엔드 배포 (Vercel 등)**:
- **기본 설정**: 실행 루트 인식 확인
- **루트 디렉토리**: `frontend`로 설정
- **환경변수**: `NEXT_PUBLIC_API_URL` 설정 (백엔드 URL 확인 후 `https://` 반드시 포함)
- **기능 확인**: 모든 기능 확인 후 문제 발견 시 피드백

**데이터베이스 (SQLite 등, 필요 시)**:
- **테스트 fixture**: connection 명시적 유지, `Session(bind=db_connection)` 사용
- **대안**: `tmp_path` fixture로 각 테스트마다 임시 파일 기반 SQLite 사용

---

## 📌 핵심 체크리스트

### 프로젝트 시작 전
- [ ] 프로젝트 폴더 및 `/docs` 디렉토리 생성
- [ ] PRD 파일 준비
- [ ] TODOs.md 작성 및 정제
- [ ] AGENTS.md 준비
- [ ] Cursor Rules 작성
- [ ] API Contract 동기화 규칙 추가

### Phase 진행 시 (각 Phase마다)
- [ ] AGENTS.md와 커서룰 적용 확인
- [ ] Phase별 점검 (파일 정합성, 함수 재사용, 호출 순서)
- [ ] 테스트 실행 (실제 데이터, E2E, 로그 보강)
- [ ] TODOs.md 업데이트
- [ ] Git 커밋 실행

### 프로젝트 완료 후
- [ ] `run build` 실행하여 타입 에러 확인
- [ ] 모든 Phase 완료 확인
- [ ] README.md 최종 업데이트
- [ ] 배포 전 최종 검증 (배포 시)
